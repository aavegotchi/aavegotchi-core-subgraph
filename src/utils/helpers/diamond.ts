import { BigInt, Address, ethereum, store } from "@graphprotocol/graph-ts";
import { ItemTypeOwnership } from "../../../generated/schema";

// Address of the actual wearable token contract
export const WEARABLE_TOKEN_ADDRESS = Address.fromString(
  "0x58de9AaBCaeEC0f69883C94318810ad79Cc6a44f"
);

export function updateOwnership(
  itemTypeId: string,
  owner: Address,
  amount: BigInt,
  timestamp: BigInt
): void {
  const ownershipId = `${itemTypeId}-${owner.toHexString()}`;
  let ownership = ItemTypeOwnership.load(ownershipId);

  if (!ownership) {
    ownership = new ItemTypeOwnership(ownershipId);
    ownership.itemType = itemTypeId;
    ownership.owner = owner;
    ownership.balance = BigInt.fromI32(0);
  }

  ownership.balance = ownership.balance.plus(amount);
  ownership.lastUpdated = timestamp;

  if (ownership.balance.equals(BigInt.fromI32(0))) {
    store.remove("ItemTypeOwnership", ownershipId);
  } else {
    ownership.save();
  }
}

export const missingFromBaseSepolia = [
  "33",
  "107",
  "145",
  "156",
  "161",
  "163",
  "164",
  "165",
  "166",
  "167",
  "168",
  "169",
  "170",
  "171",
  "172",
  "173",
  "174",
  "175",
  "176",
  "177",
  "178",
  "179",
  "180",
  "181",
  "182",
  "183",
  "184",
  "185",
  "186",
  "187",
  "188",
  "189",
  "190",
  "191",
  "192",
  "193",
  "194",
  "195",
  "196",
  "198",
  "210",
  "212",
  "214",
  "238",
  "258",
  "259",
  "260",
  "264",
  "265",
  "266",
  "267",
  "268",
  "269",
  "270",
  "271",
  "272",
  "273",
  "275",
  "276",
  "277",
  "278",
  "279",
  "280",
  "281",
  "282",
  "283",
  "284",
  "285",
  "286",
  "287",
  "288",
  "289",
  "290",
  "291",
  "316",
  "317",
  "318",
  "319",
  "320",
  "321",
  "322",
  "323",
  "324",
  "325",
  "329",
  "330",
  "331",
  "332",
  "333",
  "334",
  "335",
  "336",
  "337",
  "338",
  "339",
  "340",
  "341",
  "342",
  "343",
  "344",
  "345",
  "346",
  "347",
  "348",
  "349",
  "358",
  "359",
  "361",
  "365",
  "366",
  "367",
  "368",
  "369",
  "381",
  "382",
  "385",
  "386",
  "387",
  "388",
  "389",
  "390",
  "391",
  "392",
  "393",
  "394",
  "395",
  "396",
  "398",
  "399",
  "400",
  "401",
  "402",
  "403",
  "414",
  "415",
  "416",
  "417",
];
